<VirtualHost *:80>
    # DocumentRoot は Next.js の公開フォルダ
    DocumentRoot /var/www/html/client/public

    <Directory /var/www/html/client/public>
        AllowOverride All
        Require all granted
    </Directory>

    # .next フォルダの設定
    <Directory /var/www/html/client/.next>
        AllowOverride All
        Require all granted
    </Directory>

    # Laravel バックエンド用の設定
    <Directory /var/www/html/server/public>
        AllowOverride All
        Require all granted
    </Directory>

    # Next.js アプリケーションのサーバーサイドリクエストを Apache によって処理させる設定
    RewriteEngine On

    # フロントエンドリクエストのリダイレクト設定
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^ /index.html [L]

    # Laravel バックエンドへのリクエスト設定
    RewriteCond %{REQUEST_URI} ^/api/
    RewriteRule ^api/(.*)$ /server/public/index.php?/$1 [L,QSA]

    # その他の設定
</VirtualHost>
